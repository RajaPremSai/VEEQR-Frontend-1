import{r as t,j as e}from"./chunk-Cm16MDj1.js";import{a as C}from"./chunk-BrHt4W7n.js";const M=t.createContext(null);function $({children:i}){const[d,v]=t.useState(()=>localStorage.getItem("token")||""),[p,o]=t.useState(()=>{const h=localStorage.getItem("profile");return h?JSON.parse(h):null});t.useEffect(()=>{d?localStorage.setItem("token",d):localStorage.removeItem("token")},[d]),t.useEffect(()=>{p?localStorage.setItem("profile",JSON.stringify(p)):localStorage.removeItem("profile")},[p]);const l=async(h,j)=>{const{data:m}=await C.post("/api/auth/login",{email:h,password:j});return v(m.token),o(m.profile),m},c=()=>{v(""),o(null)},x=t.useMemo(()=>({token:d,profile:p,isAuthenticated:!!d,login:l,logout:c}),[d,p]);return e.jsx(M.Provider,{value:x,children:i})}const O=()=>t.useContext(M);function V(){const{profile:i}=O(),[d,v]=t.useState({vehicleCount:0,recentLogs:[],totalEntries:0,loading:!0}),p=async()=>{try{const[l,c]=await Promise.all([C.get("/api/users/vehicles"),C.get("/api/users/logs")]),x=l.data.vehicles||[],h=c.data.logs||[];v({vehicleCount:x.length,recentLogs:h.slice(0,3),totalEntries:h.length,loading:!1})}catch{v(c=>({...c,loading:!1}))}};t.useEffect(()=>{p()},[]);const o=l=>l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e.jsxs("div",{className:"dashboard-container fade-in",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsxs("div",{className:"welcome-section",children:[e.jsxs("h1",{className:"welcome-title",children:["Welcome back, ",i?.firstName||i?.email?.split("@")[0],"!"]}),e.jsx("p",{className:"welcome-subtitle",children:"Here's an overview of your vehicle activity"})]}),e.jsx("div",{className:"user-avatar-large",children:e.jsx("div",{className:"avatar-circle",children:(i?.firstName?.[0]||i?.email?.[0]||"U").toUpperCase()})})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:"ðŸš—"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:d.loading?"...":d.vehicleCount}),e.jsx("div",{className:"stat-label",children:"My Vehicles"}),e.jsx("div",{className:"stat-description",children:d.vehicleCount===1?"Vehicle registered":"Vehicles registered"})]})]}),e.jsxs("div",{className:"stat-card success",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ“Š"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:d.loading?"...":d.totalEntries}),e.jsx("div",{className:"stat-label",children:"Total Entries"}),e.jsx("div",{className:"stat-description",children:"All-time entry records"})]})]}),e.jsxs("div",{className:"stat-card info",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ•’"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:d.loading?"...":d.recentLogs.length}),e.jsx("div",{className:"stat-label",children:"Recent Activity"}),e.jsx("div",{className:"stat-description",children:"Last 7 days"})]})]})]}),e.jsxs("div",{className:"quick-actions-section",children:[e.jsx("h3",{className:"section-title",children:"Quick Actions"}),e.jsxs("div",{className:"quick-actions-grid",children:[e.jsxs("a",{href:"/user/vehicles",className:"action-card touch-target",children:[e.jsx("div",{className:"action-icon",children:"âž•"}),e.jsxs("div",{className:"action-content",children:[e.jsx("div",{className:"action-title",children:"Add Vehicle"}),e.jsx("div",{className:"action-description",children:"Register a new vehicle"})]})]}),e.jsxs("a",{href:"/user/vehicles",className:"action-card touch-target",children:[e.jsx("div",{className:"action-icon",children:"ðŸš™"}),e.jsxs("div",{className:"action-content",children:[e.jsx("div",{className:"action-title",children:"Manage Vehicles"}),e.jsx("div",{className:"action-description",children:"View and edit your vehicles"})]})]}),e.jsxs("a",{href:"/user/logs",className:"action-card touch-target",children:[e.jsx("div",{className:"action-icon",children:"ðŸ“‹"}),e.jsxs("div",{className:"action-content",children:[e.jsx("div",{className:"action-title",children:"View Logs"}),e.jsx("div",{className:"action-description",children:"Check entry/exit history"})]})]}),e.jsxs("a",{href:"/user/profile",className:"action-card touch-target",children:[e.jsx("div",{className:"action-icon",children:"ðŸ‘¤"}),e.jsxs("div",{className:"action-content",children:[e.jsx("div",{className:"action-title",children:"Update Profile"}),e.jsx("div",{className:"action-description",children:"Edit personal information"})]})]})]})]}),e.jsxs("div",{className:"recent-activity-section",children:[e.jsx("h3",{className:"section-title",children:"Recent Activity"}),e.jsx("div",{className:"activity-card",children:d.loading?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading recent activity..."})]}):d.recentLogs.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“"}),e.jsx("div",{className:"empty-title",children:"No recent activity"}),e.jsx("div",{className:"empty-description",children:"Your vehicle entry/exit logs will appear here"})]}):e.jsx("div",{className:"activity-list",children:d.recentLogs.map((l,c)=>e.jsxs("div",{className:"activity-item",children:[e.jsx("div",{className:"activity-indicator",children:e.jsx("div",{className:`activity-dot ${l.timeOut?"completed":"active"}`})}),e.jsxs("div",{className:"activity-content",children:[e.jsxs("div",{className:"activity-main",children:[e.jsx("span",{className:"activity-vehicle",children:l.vehicleNumber}),e.jsxs("span",{className:"activity-action",children:[l.timeOut?"Exited":"Entered"," Gate"," ",l.gateNumber]})]}),e.jsxs("div",{className:"activity-meta",children:[e.jsx("span",{className:"activity-time",children:o(l.timeOut||l.timeIn)}),l.timeOut&&l.timeIn&&e.jsxs("span",{className:"activity-duration",children:["Duration:"," ",Math.round((new Date(l.timeOut)-new Date(l.timeIn))/(1e3*60))," ","min"]})]})]})]},l._id||c))})})]})]})}function F(){const[i,d]=t.useState([]),[v,p]=t.useState([]),[o,l]=t.useState({vehicleNumber:"",vehicleType:"Car",vehicleModelName:"",vehicleOwner:"",driverName:"",driverMobileNumber:""}),[c,x]=t.useState(!1),[h,j]=t.useState(!1),[m,S]=t.useState(""),[b,D]=t.useState("All"),[a,n]=t.useState({}),u=async()=>{x(!0);try{const{data:s}=await C.get("/api/users/vehicles");d(s.vehicles||[]),p(s.vehicles||[])}catch{}finally{x(!1)}};t.useEffect(()=>{u()},[]),t.useEffect(()=>{let s=i;b!=="All"&&(s=s.filter(N=>N.vehicleType===b)),m&&(s=s.filter(N=>N.vehicleNumber.toLowerCase().includes(m.toLowerCase())||N.vehicleModelName&&N.vehicleModelName.toLowerCase().includes(m.toLowerCase())||N.vehicleOwner.toLowerCase().includes(m.toLowerCase()))),p(s)},[i,m,b]);const f=()=>{const s={};return o.vehicleNumber.trim()||(s.vehicleNumber="Vehicle number is required"),o.vehicleOwner.trim()||(s.vehicleOwner="Vehicle owner is required"),o.driverMobileNumber&&!/^\d{10}$/.test(o.driverMobileNumber.replace(/\D/g,""))&&(s.driverMobileNumber="Please enter a valid 10-digit mobile number"),n(s),Object.keys(s).length===0},y=async s=>{if(s.preventDefault(),!!f()){x(!0);try{await C.post("/api/users/vehicles",o),l({vehicleNumber:"",vehicleType:"Car",vehicleModelName:"",vehicleOwner:"",driverName:"",driverMobileNumber:""}),n({}),j(!1),await u()}catch(N){N.response?.data?.message&&n({submit:N.response.data.message})}finally{x(!1)}}},w=(s,N)=>{if(s){const L=s.startsWith("http")?s:`http://localhost:5000${s}`,A=document.createElement("a");A.href=L,A.download=`QR_${N}.png`,document.body.appendChild(A),A.click(),document.body.removeChild(A)}},r=s=>s?s.startsWith("http")?s:`http://localhost:5000${s}`:null,g=s=>({Car:"ðŸš—",Bike:"ðŸï¸",Scooter:"ðŸ›µ",Bus:"ðŸšŒ",Other:"ðŸš™"})[s]||"ðŸš™",k=["All","Car","Bike","Scooter","Bus","Other"];return e.jsxs("div",{className:"vehicles-container",children:[e.jsxs("div",{className:"vehicles-header",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{className:"page-title",children:"My Vehicles"}),e.jsx("p",{className:"page-subtitle",children:"Manage your registered vehicles and QR codes"})]}),e.jsxs("button",{className:"btn primary add-vehicle-btn",onClick:()=>j(!h),children:[e.jsx("span",{className:"btn-icon",children:"âž•"}),"Add Vehicle"]})]}),h&&e.jsx("div",{className:"add-vehicle-section",children:e.jsxs("div",{className:"form-card",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{className:"form-title",children:"Add New Vehicle"}),e.jsx("button",{className:"close-btn",onClick:()=>{j(!1),n({}),l({vehicleNumber:"",vehicleType:"Car",vehicleModelName:"",vehicleOwner:"",driverName:"",driverMobileNumber:""})},children:"âœ•"})]}),a.submit&&e.jsx("div",{className:"error-message",children:a.submit}),e.jsxs("form",{onSubmit:y,className:"vehicle-form",children:[e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Vehicle Number *"}),e.jsx("input",{className:`form-input ${a.vehicleNumber?"error":""}`,value:o.vehicleNumber||"",onChange:s=>l(N=>({...N,vehicleNumber:s.target.value.toUpperCase()})),placeholder:"e.g., MH12AB1234",required:!0}),a.vehicleNumber&&e.jsx("span",{className:"field-error",children:a.vehicleNumber})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Vehicle Type"}),e.jsxs("select",{className:"form-input",value:o.vehicleType||"",onChange:s=>l(N=>({...N,vehicleType:s.target.value})),children:[e.jsx("option",{value:"Car",children:"ðŸš— Car"}),e.jsx("option",{value:"Bike",children:"ðŸï¸ Bike"}),e.jsx("option",{value:"Scooter",children:"ðŸ›µ Scooter"}),e.jsx("option",{value:"Bus",children:"ðŸšŒ Bus"}),e.jsx("option",{value:"Other",children:"ðŸš™ Other"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Vehicle Model"}),e.jsx("input",{className:"form-input",value:o.vehicleModelName||"",onChange:s=>l(N=>({...N,vehicleModelName:s.target.value})),placeholder:"e.g., Honda City, Yamaha R15"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Vehicle Owner *"}),e.jsx("input",{className:`form-input ${a.vehicleOwner?"error":""}`,value:o.vehicleOwner||"",onChange:s=>l(N=>({...N,vehicleOwner:s.target.value})),placeholder:"Owner's full name",required:!0}),a.vehicleOwner&&e.jsx("span",{className:"field-error",children:a.vehicleOwner})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Driver Name"}),e.jsx("input",{className:"form-input",value:o.driverName||"",onChange:s=>l(N=>({...N,driverName:s.target.value})),placeholder:"Driver's name (if different from owner)"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Driver Mobile"}),e.jsx("input",{className:`form-input ${a.driverMobileNumber?"error":""}`,value:o.driverMobileNumber||"",onChange:s=>l(N=>({...N,driverMobileNumber:s.target.value})),placeholder:"10-digit mobile number",type:"tel"}),a.driverMobileNumber&&e.jsx("span",{className:"field-error",children:a.driverMobileNumber})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:()=>{j(!1),n({}),l({vehicleNumber:"",vehicleType:"Car",vehicleModelName:"",vehicleOwner:"",driverName:"",driverMobileNumber:""})},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn primary",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading-spinner small"}),"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"btn-icon",children:"ðŸ’¾"}),"Add Vehicle"]})})]})]})]})}),e.jsxs("div",{className:"vehicles-controls",children:[e.jsx("div",{className:"search-section",children:e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx("span",{className:"search-icon",children:"ðŸ”"}),e.jsx("input",{type:"text",className:"search-input",placeholder:"Search by vehicle number, model, or owner...",value:m,onChange:s=>S(s.target.value)})]})}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Filter by type:"}),e.jsx("select",{className:"filter-select",value:b,onChange:s=>D(s.target.value),children:k.map(s=>e.jsx("option",{value:s,children:s==="All"?"All Types":`${g(s)} ${s}`},s))})]})]}),e.jsx("div",{className:"vehicles-content",children:c?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading vehicles..."})]}):v.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸš—"}),e.jsx("div",{className:"empty-title",children:i.length===0?"No vehicles registered":"No vehicles match your search"}),e.jsx("div",{className:"empty-description",children:i.length===0?"Add your first vehicle to get started with QR-based entry/exit tracking":"Try adjusting your search terms or filters"}),i.length===0&&e.jsxs("button",{className:"btn primary",onClick:()=>j(!0),children:[e.jsx("span",{className:"btn-icon",children:"âž•"}),"Add Your First Vehicle"]})]}):e.jsx("div",{className:"vehicles-grid",children:v.map(s=>e.jsxs("div",{className:"vehicle-card",children:[e.jsxs("div",{className:"vehicle-header",children:[e.jsx("div",{className:"vehicle-icon",children:g(s.vehicleType)}),e.jsx("div",{className:"vehicle-number",children:s.vehicleNumber}),e.jsx("div",{className:"vehicle-type-badge",children:s.vehicleType})]}),e.jsxs("div",{className:"vehicle-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Model:"}),e.jsx("span",{className:"detail-value",children:s.vehicleModelName||"Not specified"})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Owner:"}),e.jsx("span",{className:"detail-value",children:s.vehicleOwner})]}),s.driverName&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Driver:"}),e.jsx("span",{className:"detail-value",children:s.driverName})]}),s.driverMobileNumber&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Mobile:"}),e.jsx("span",{className:"detail-value",children:s.driverMobileNumber})]})]}),e.jsx("div",{className:"vehicle-qr-section",children:s.qr?.imageUrl?e.jsxs("div",{className:"qr-available",children:[e.jsx("div",{className:"qr-preview",children:e.jsx("img",{src:r(s.qr.imageUrl),alt:`QR Code for ${s.vehicleNumber}`,className:"qr-image"})}),e.jsxs("div",{className:"qr-actions",children:[e.jsxs("a",{href:r(s.qr.imageUrl),target:"_blank",rel:"noopener noreferrer",className:"btn secondary small",children:[e.jsx("span",{className:"btn-icon",children:"ðŸ‘ï¸"}),"View"]}),e.jsxs("button",{onClick:()=>w(s.qr.imageUrl,s.vehicleNumber),className:"btn primary small",children:[e.jsx("span",{className:"btn-icon",children:"â¬‡ï¸"}),"Download"]})]})]}):e.jsxs("div",{className:"qr-generating",children:[e.jsx("div",{className:"qr-placeholder",children:e.jsx("div",{className:"loading-spinner small"})}),e.jsx("span",{className:"qr-status",children:"Generating QR Code..."})]})})]},s._id))})}),!c&&i.length>0&&e.jsxs("div",{className:"results-summary",children:["Showing ",v.length," of ",i.length," vehicles",m&&` matching "${m}"`,b!=="All"&&` filtered by ${b}`]})]})}function R(){const[i,d]=t.useState([]),[v,p]=t.useState([]),[o,l]=t.useState(!1),[c,x]=t.useState({vehicleNumber:"",dateRange:"all",status:"all"}),h=async()=>{l(!0);try{const{data:a}=await C.get("/api/users/logs"),n=(a.logs||[]).sort((u,f)=>new Date(f.timeIn||f.createdAt)-new Date(u.timeIn||u.createdAt));d(n),p(n)}catch{}finally{l(!1)}};t.useEffect(()=>{h()},[]),t.useEffect(()=>{let a=i;if(c.vehicleNumber&&(a=a.filter(n=>n.vehicleNumber.toLowerCase().includes(c.vehicleNumber.toLowerCase()))),c.dateRange!=="all"){const n=new Date,u=new Date;switch(c.dateRange){case"today":u.setHours(0,0,0,0);break;case"week":u.setDate(n.getDate()-7);break;case"month":u.setMonth(n.getMonth()-1);break}a=a.filter(f=>new Date(f.timeIn||f.createdAt)>=u)}c.status!=="all"&&(a=a.filter(n=>c.status==="active"?!n.timeOut:c.status==="completed"?n.timeOut:!0)),p(a)},[i,c]);const j=a=>{if(!a)return"-";const n=new Date(a);return{date:n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:n.getFullYear()!==new Date().getFullYear()?"numeric":void 0}),time:n.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},m=(a,n)=>{if(!a||!n)return null;const u=Math.round((new Date(n)-new Date(a))/(1e3*60));if(u<60)return`${u}m`;const f=Math.floor(u/60),y=u%60;return`${f}h ${y}m`},S=a=>a.timeOut?{status:"completed",label:"Completed",icon:"âœ…",color:"success"}:{status:"active",label:"Active",icon:"ðŸŸ¢",color:"info"},b=()=>{x({vehicleNumber:"",dateRange:"all",status:"all"})},D=c.vehicleNumber||c.dateRange!=="all"||c.status!=="all";return e.jsxs("div",{className:"logs-container",children:[e.jsxs("div",{className:"logs-header",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{className:"page-title",children:"Vehicle Logs"}),e.jsx("p",{className:"page-subtitle",children:"Track your vehicle entry and exit history"})]}),e.jsxs("div",{className:"logs-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:i.length}),e.jsx("span",{className:"stat-label",children:"Total Logs"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:i.filter(a=>!a.timeOut).length}),e.jsx("span",{className:"stat-label",children:"Active"})]})]})]}),e.jsxs("div",{className:"logs-filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Vehicle Number"}),e.jsx("input",{type:"text",className:"filter-input",placeholder:"Search by vehicle number...",value:c.vehicleNumber,onChange:a=>x(n=>({...n,vehicleNumber:a.target.value}))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Date Range"}),e.jsxs("select",{className:"filter-select",value:c.dateRange,onChange:a=>x(n=>({...n,dateRange:a.target.value})),children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Status"}),e.jsxs("select",{className:"filter-select",value:c.status,onChange:a=>x(n=>({...n,status:a.target.value})),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"ðŸŸ¢ Active"}),e.jsx("option",{value:"completed",children:"âœ… Completed"})]})]}),D&&e.jsxs("button",{className:"clear-filters-btn",onClick:b,children:[e.jsx("span",{className:"btn-icon",children:"ðŸ—‘ï¸"}),"Clear Filters"]})]}),e.jsx("div",{className:"logs-content",children:o?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading logs..."})]}):v.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“‹"}),e.jsx("div",{className:"empty-title",children:i.length===0?"No logs found":"No logs match your filters"}),e.jsx("div",{className:"empty-description",children:i.length===0?"Your vehicle entry/exit logs will appear here once you start using the system":"Try adjusting your filters to see more results"}),D&&e.jsx("button",{className:"btn secondary",onClick:b,children:"Clear Filters"})]}):e.jsx("div",{className:"timeline-container",children:e.jsx("div",{className:"timeline",children:v.map((a,n)=>{const u=j(a.timeIn),f=j(a.timeOut),y=m(a.timeIn,a.timeOut),w=S(a);return e.jsxs("div",{className:"timeline-item",children:[e.jsxs("div",{className:"timeline-marker",children:[e.jsx("div",{className:`timeline-dot ${w.status}`,children:e.jsx("span",{className:"timeline-icon",children:w.icon})}),n<v.length-1&&e.jsx("div",{className:"timeline-line"})]}),e.jsx("div",{className:"timeline-content",children:e.jsxs("div",{className:"log-card",children:[e.jsxs("div",{className:"log-header",children:[e.jsxs("div",{className:"log-vehicle",children:[e.jsx("span",{className:"vehicle-icon",children:"ðŸš—"}),e.jsx("span",{className:"vehicle-number",children:a.vehicleNumber})]}),e.jsxs("div",{className:`log-status ${w.color}`,children:[e.jsx("span",{className:"status-icon",children:w.icon}),e.jsx("span",{className:"status-label",children:w.label})]})]}),e.jsxs("div",{className:"log-details",children:[e.jsxs("div",{className:"log-section",children:[e.jsx("div",{className:"section-title",children:"Entry Details"}),e.jsxs("div",{className:"detail-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Gate"}),e.jsxs("span",{className:"detail-value",children:["Gate ",a.gateNumber]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Date"}),e.jsx("span",{className:"detail-value",children:u.date})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Time"}),e.jsx("span",{className:"detail-value",children:u.time})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Guard"}),e.jsx("span",{className:"detail-value",children:a.securityGuardName||"N/A"})]})]})]}),a.timeOut&&e.jsxs("div",{className:"log-section",children:[e.jsx("div",{className:"section-title",children:"Exit Details"}),e.jsxs("div",{className:"detail-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Date"}),e.jsx("span",{className:"detail-value",children:f.date})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Time"}),e.jsx("span",{className:"detail-value",children:f.time})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Duration"}),e.jsx("span",{className:"detail-value duration",children:y})]})]})]})]}),e.jsx("div",{className:"log-footer",children:e.jsxs("div",{className:"log-id",children:["Log ID: ",a.logId||a._id.slice(-8)]})})]})})]},a._id)})})})}),!o&&i.length>0&&e.jsxs("div",{className:"results-summary",children:["Showing ",v.length," of ",i.length," logs",D&&" (filtered)"]})]})}function I(){const[i,d]=t.useState([]);return t.useEffect(()=>{(async()=>{const{data:v}=await C.get("/api/users/announcements");d(v.announcements||[])})()},[]),e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"Announcements"}),i.map(v=>e.jsxs("div",{className:"card",children:[e.jsx("strong",{children:v.title}),e.jsx("div",{children:v.description}),e.jsx("small",{children:new Date(v.date||v.createdAt).toLocaleString()})]},v._id))]})}function U(){const[i,d]=t.useState(null),[v,p]=t.useState(!1),[o,l]=t.useState("personal"),[c,x]=t.useState(!1),[h,j]=t.useState({}),[m,S]=t.useState({}),[b,D]=t.useState(!1),a=async()=>{p(!0);try{const{data:r}=await C.get("/api/users/profile");d(r.profile),j(r.profile)}catch{}finally{p(!1)}};t.useEffect(()=>{a()},[]);const n=()=>{const r={};return h.firstName?.trim()||(r.firstName="First name is required"),h.lastName?.trim()||(r.lastName="Last name is required"),h.contactNumber&&!/^\d{10}$/.test(h.contactNumber.replace(/\D/g,""))&&(r.contactNumber="Please enter a valid 10-digit contact number"),S(r),Object.keys(r).length===0},u=async()=>{if(n()){D(!0);try{const{data:r}=await C.put("/api/users/profile",{firstName:h.firstName,lastName:h.lastName,middleName:h.middleName,contactNumber:h.contactNumber});d(r.profile),x(!1),S({})}catch(r){r.response?.data?.message&&S({submit:r.response.data.message})}finally{D(!1)}}},f=()=>{j(i),x(!1),S({})},y=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",w=(r,g)=>`${r?.[0]||""}${g?.[0]||""}`.toUpperCase();return v?e.jsx("div",{className:"profile-container",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading profile..."})]})}):i?e.jsxs("div",{className:"profile-container",children:[e.jsxs("div",{className:"profile-header",children:[e.jsxs("div",{className:"profile-avatar-section",children:[e.jsx("div",{className:"profile-avatar",children:w(i.firstName,i.lastName)}),e.jsxs("div",{className:"profile-basic-info",children:[e.jsxs("h1",{className:"profile-name",children:[i.firstName," ",i.middleName?i.middleName+" ":"",i.lastName]}),e.jsxs("div",{className:"profile-role",children:[e.jsx("span",{className:"role-badge",children:i.role}),e.jsx("span",{className:"user-type",children:i.userType})]}),e.jsx("div",{className:"profile-email",children:i.email})]})]}),e.jsx("div",{className:"profile-actions",children:c?e.jsxs("div",{className:"edit-actions",children:[e.jsx("button",{className:"btn secondary",onClick:f,disabled:b,children:"Cancel"}),e.jsx("button",{className:"btn primary",onClick:u,disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading-spinner small"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"btn-icon",children:"ðŸ’¾"}),"Save Changes"]})})]}):e.jsxs("button",{className:"btn primary",onClick:()=>x(!0),children:[e.jsx("span",{className:"btn-icon",children:"âœï¸"}),"Edit Profile"]})})]}),e.jsxs("div",{className:"profile-tabs",children:[e.jsxs("button",{className:`tab-button ${o==="personal"?"active":""}`,onClick:()=>l("personal"),children:[e.jsx("span",{className:"tab-icon",children:"ðŸ‘¤"}),"Personal Information"]}),e.jsxs("button",{className:`tab-button ${o==="account"?"active":""}`,onClick:()=>l("account"),children:[e.jsx("span",{className:"tab-icon",children:"âš™ï¸"}),"Account Details"]}),e.jsxs("button",{className:`tab-button ${o==="activity"?"active":""}`,onClick:()=>l("activity"),children:[e.jsx("span",{className:"tab-icon",children:"ðŸ“Š"}),"Activity Summary"]})]}),e.jsxs("div",{className:"profile-content",children:[m.submit&&e.jsx("div",{className:"error-message",children:m.submit}),o==="personal"&&e.jsx("div",{className:"tab-content",children:e.jsxs("div",{className:"info-section",children:[e.jsx("h3",{className:"section-title",children:"Personal Information"}),e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"First Name"}),c?e.jsxs("div",{className:"edit-field",children:[e.jsx("input",{type:"text",className:`form-input ${m.firstName?"error":""}`,value:h.firstName||"",onChange:r=>j(g=>({...g,firstName:r.target.value})),placeholder:"Enter first name"}),m.firstName&&e.jsx("span",{className:"field-error",children:m.firstName})]}):e.jsx("div",{className:"info-value",children:i.firstName})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"Middle Name"}),c?e.jsx("input",{type:"text",className:"form-input",value:h.middleName||"",onChange:r=>j(g=>({...g,middleName:r.target.value})),placeholder:"Enter middle name (optional)"}):e.jsx("div",{className:"info-value",children:i.middleName||"Not provided"})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"Last Name"}),c?e.jsxs("div",{className:"edit-field",children:[e.jsx("input",{type:"text",className:`form-input ${m.lastName?"error":""}`,value:h.lastName||"",onChange:r=>j(g=>({...g,lastName:r.target.value})),placeholder:"Enter last name"}),m.lastName&&e.jsx("span",{className:"field-error",children:m.lastName})]}):e.jsx("div",{className:"info-value",children:i.lastName})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"Contact Number"}),c?e.jsxs("div",{className:"edit-field",children:[e.jsx("input",{type:"tel",className:`form-input ${m.contactNumber?"error":""}`,value:h.contactNumber||"",onChange:r=>j(g=>({...g,contactNumber:r.target.value})),placeholder:"Enter 10-digit contact number"}),m.contactNumber&&e.jsx("span",{className:"field-error",children:m.contactNumber})]}):e.jsx("div",{className:"info-value",children:i.contactNumber||"Not provided"})]})]})]})}),o==="account"&&e.jsx("div",{className:"tab-content",children:e.jsxs("div",{className:"info-section",children:[e.jsx("h3",{className:"section-title",children:"Account Details"}),e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"Employee Number"}),e.jsx("div",{className:"info-value",children:i.empNumber})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"Email Address"}),e.jsx("div",{className:"info-value",children:i.email})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"User Type"}),e.jsx("div",{className:"info-value",children:e.jsx("span",{className:"type-badge",children:i.userType})})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"Role"}),e.jsx("div",{className:"info-value",children:e.jsx("span",{className:"role-badge",children:i.role})})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"Member Since"}),e.jsx("div",{className:"info-value",children:y(i.createdAt)})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{className:"info-label",children:"Last Updated"}),e.jsx("div",{className:"info-value",children:y(i.updatedAt)})]})]})]})}),o==="activity"&&e.jsx("div",{className:"tab-content",children:e.jsxs("div",{className:"info-section",children:[e.jsx("h3",{className:"section-title",children:"Activity Summary"}),e.jsxs("div",{className:"activity-stats",children:[e.jsxs("div",{className:"activity-card",children:[e.jsx("div",{className:"activity-icon",children:"ðŸš—"}),e.jsxs("div",{className:"activity-content",children:[e.jsx("div",{className:"activity-number",children:"-"}),e.jsx("div",{className:"activity-label",children:"Vehicles Registered"})]})]}),e.jsxs("div",{className:"activity-card",children:[e.jsx("div",{className:"activity-icon",children:"ðŸ“Š"}),e.jsxs("div",{className:"activity-content",children:[e.jsx("div",{className:"activity-number",children:"-"}),e.jsx("div",{className:"activity-label",children:"Total Entries"})]})]}),e.jsxs("div",{className:"activity-card",children:[e.jsx("div",{className:"activity-icon",children:"ðŸ•’"}),e.jsxs("div",{className:"activity-content",children:[e.jsx("div",{className:"activity-number",children:"-"}),e.jsx("div",{className:"activity-label",children:"This Month"})]})]})]}),e.jsx("div",{className:"activity-note",children:e.jsx("p",{children:"Detailed activity statistics will be available once you start using the vehicle tracking system."})})]})})]})]}):e.jsx("div",{className:"profile-container",children:e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ‘¤"}),e.jsx("div",{className:"empty-title",children:"Profile not found"}),e.jsx("div",{className:"empty-description",children:"Unable to load your profile information"})]})})}export{$ as A,V as U,F as a,R as b,I as c,U as d,O as u};
